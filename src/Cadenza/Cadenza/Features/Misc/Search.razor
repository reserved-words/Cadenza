@inherits SearchBase

<MudToolBar DisableGutters="true">

    @if (IsLoading)
    {
        <MudText></MudText>
    }
    else
    {
        <MudAutocomplete T="SearchItemVM"
                         Class="ma-0 pa-0"
                         Label="Search"
                         @bind-Value="Result"
                         SearchFunc="@Search"
                         ToStringFunc="@(e => e == null ? null : e.Name)"
                         CoerceText=true
                         CoerceValue=false
                         MaxItems=50
                         Variant="@Variant.Text"
                         MinCharacters=3
                         ResetValueOnEmptyText=true
                         Disabled="@Disabled">
            <ItemTemplate Context="e">
                <MudContainer Class="d-flex flex-row pa-0 ma-0">
                    <MudIcon Icon="@e.Type.GetIcon()"
                             Class="mb-n1 mr-2"
                             Color="@Color.Surface" />
                    <MudContainer Class="pa-0 ma-0">
                        <MudText Color=Color.Surface
                                 Typo="@Typo.body1"
                                 Class="pa-0 ma-0">
                            @e.Name
                        </MudText>
                        <MudText Color=Color.Surface
                                 Typo="@Typo.body2"
                                 Class="pa-0 ma-0">
                            @e.Artist
                        </MudText>
                        <MudText Color=Color.Surface
                                 Typo="@Typo.body2"
                                 Class="pa-0 ma-0">
                            @e.AlbumDisplay
                        </MudText>
                    </MudContainer>
                </MudContainer>
            </ItemTemplate>
        </MudAutocomplete>
    }

</MudToolBar>

@code {
    [Inject] public IState<ViewState> ViewState { get; set; }

    protected bool Disabled => ViewState.Value.IsNavigationDisabled;
}