@using Cadenza.Web.Common.Interfaces.Play;

<AppTable Items="@Model.Tracks"
          OnRowDoubleClick="@OnDoubleClick">
    <RowTemplate>
        <MudTd Class="td-int">@context.TrackNo</MudTd>
        <MudTd>
            <TrackLink Typo="@Typo.body1" Id="@context.TrackId" Title="@context.Title" />
        </MudTd>
        <MudTd>
            @if (context.ArtistId != AlbumArtistId)
            {
                <ArtistLink Typo="@Typo.body1" Id="@context.ArtistId" Name="@context.ArtistName" />
            }
        </MudTd>
        <MudTd Class="td-int">@context.Duration()</MudTd>
    </RowTemplate>
</AppTable>

@code {
    [Inject]
    public IItemPlayer ItemPlayer { get; set; }

    [Parameter]
    public Disc Model { get; set; } = new();

    [Parameter]
    public string AlbumId { get; set; }

    [Parameter]
    public string AlbumArtistId { get; set; }

    [Inject]
    public IDebugLogger Logger { get; set; }

    protected async Task OnDoubleClick(AlbumTrack track)
    {
        await ItemPlayer.PlayAlbum(AlbumId, track.TrackId);
    }
}
