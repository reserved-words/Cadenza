@using Cadenza.Common.Domain.Extensions

@inherits PlayerBase

@*Position relative needed to keep overlay inside card*@

<MudCard Elevation="3" Class="pa-0 ma-0" Style="position: relative;">
    <MudOverlay Visible="@Loading" LightBackground="true" Absolute="true">
        <MudProgressCircular Color="Color.Primary" Indeterminate="true" />
    </MudOverlay>
    <MudOverlay Visible="@Empty" LightBackground="true" Absolute="true">
    </MudOverlay>
    <MudCardHeader Class="pa-2">
        <CardHeaderContent>
            <CurrentTrack Model="@Model?.Track" />
        </CardHeaderContent>
        <CardHeaderActions>
            @*            <FavouriteTrack Artist="@Model.Artist.Name" Title="@Model.Track.Title" IsFavourite="@null" />
            *@
        </CardHeaderActions>
    </MudCardHeader>
    <CurrentTrackArtwork Model="@Model" />
    <MudProgressLinear @bind-Value="@Progress" Color="Color.Primary" Class="ma-0" />
    <MudCardContent Class="pa-2">
        <CurrentTrackAlbum Model="@Model?.Album" />
    </MudCardContent>

</MudCard>

<MudButtonGroup Color="Color.Dark" Variant="Variant.Filled" Class="ma-0 pa-0">
    <MudIconButton Icon="@Icons.Material.Filled.SkipPrevious" OnClick="SkipPrevious" Disabled="@(!CanSkipPrevious)" />
    <MudIconButton Icon="@Icons.Material.Filled.PlayArrow" OnClick="Resume" Disabled="@(!CanPlay)" Class="@PlayButtonClass()" />
    <MudIconButton Icon="@Icons.Material.Filled.Pause" OnClick="Pause" Disabled="@(!CanPause)" Class="@PauseButtonClass()" />
    <MudIconButton Icon="@Icons.Material.Filled.SkipNext" OnClick="SkipNext" Disabled="@(!CanSkipNext)" />
</MudButtonGroup>

@code {

    private string PlayButtonClass()
    {
        var show = (!CanPlay && !CanPause)
            || CanPlay;

        return Display(show);
    }

    private string PauseButtonClass()
    {
        return Display(CanPause);
    }

    private string Display(bool show)
    {
        return show ? "d-flex" : "d-none";
    }
}