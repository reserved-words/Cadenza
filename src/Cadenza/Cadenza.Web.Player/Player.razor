@using Cadenza.Common.Domain.Extensions

@inherits PlayerBase

@*Position relative needed to keep overlay inside card*@

<MudCard Elevation="3" Class="pa-0 ma-0" Style="position: relative;">
    <MudOverlay Visible="@Loading" LightBackground="true" Absolute="true">
        <MudProgressCircular Color="Color.Primary" Indeterminate="true" />
    </MudOverlay>
    <MudOverlay Visible="@Empty" LightBackground="true" Absolute="true">
    </MudOverlay>
    <MudCardHeader Class="pa-2">
        <CardHeaderContent>

            <MudText Typo="@Typo.h6">@Title</MudText>
            <MudText Typo="@Typo.body1">@Artist</MudText>

            @*            <TrackLink Typo="@Typo.h6" Id="@Model.Track.Id" Title="@Model.Track.Title" />
                <ArtistLink Typo="@Typo.body1" Id="@Model.Artist.Id" Name="@Model.Artist.Name" />
            *@
        </CardHeaderContent>
        <CardHeaderActions>
            @*            <FavouriteTrack Artist="@Model.Artist.Name" Title="@Model.Track.Title" IsFavourite="@null" />
            *@
        </CardHeaderActions>
    </MudCardHeader>
    <img src="@ArtworkUrl" class="artwork" />
    <MudProgressLinear @bind-Value="@Progress" Color="Color.Primary" Class="ma-0" />
    <MudCardContent Class="pa-2">

            <MudText Typo="@Typo.h6">@AlbumTitle</MudText>
            <MudText Typo="@Typo.h6">@AlbumArtist</MudText>

        @*        <AlbumLink Typo="@Typo.body1" Id="@Model.Album.Id" Title="@Model.Album.Title" />
            <ArtistLink Typo="@Typo.body2" Id="@Model.Album.ArtistId" Name="@Model.Album.ArtistName" />
        *@        <MudText Typo="Typo.body1">@ReleaseType</MudText>
        <MudText Typo="Typo.body2">@Year</MudText>
    </MudCardContent>

</MudCard>

<MudButtonGroup Color="Color.Dark" Variant="Variant.Filled" Class="ma-0 pa-0">
    <MudIconButton Icon="@Icons.Material.Filled.SkipPrevious" OnClick="SkipPrevious" Disabled="@(!CanSkipPrevious)" />
    <MudIconButton Icon="@Icons.Material.Filled.PlayArrow" OnClick="Resume" Disabled="@(!CanPlay)" Class="@PlayButtonClass()" />
    <MudIconButton Icon="@Icons.Material.Filled.Pause" OnClick="Pause" Disabled="@(!CanPause)" Class="@PauseButtonClass()" />
    <MudIconButton Icon="@Icons.Material.Filled.SkipNext" OnClick="SkipNext" Disabled="@(!CanSkipNext)" />
</MudButtonGroup>

@code {

    private string PlayButtonClass()
    {
        var show = (!CanPlay && !CanPause)
            || CanPlay;

        return Display(show);
    }

    private string PauseButtonClass()
    {
        return Display(CanPause);
    }

    private string Display(bool show)
    {
        return show ? "d-flex" : "d-none";
    }
}