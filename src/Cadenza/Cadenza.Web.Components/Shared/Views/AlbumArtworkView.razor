@using Cadenza.State.Actions;

@if (Model != null)
{
    <img class="artwork" src="@ArtworkSrc" @ondblclick="@Play" />
}

@code {
    [Inject]
    public IDispatcher Dispatcher { get; set; }

    [Inject]
    public IArtworkFetcher ArtworkFetcher { get; set; }

    [Parameter]
    public Album Model { get; set; }

    public string ArtworkSrc { get; private set; }

    protected override void OnParametersSet()
    {
        ArtworkSrc = ArtworkFetcher.GetAlbumArtworkSrc(Model);
    }

    public Task Play()
    {
        Dispatcher.Dispatch(new PlayAlbumRequest(Model.Id, 0));
        return Task.CompletedTask;
    }
}