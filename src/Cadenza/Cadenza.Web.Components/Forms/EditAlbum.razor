@using Cadenza.Common.Interfaces.Repositories;
@using Cadenza.Web.Components.Forms.Album
@inherits EditAlbumBase

<AppDialog Cancel="OnCancel"
           CancelCaption="Cancel"
           Submit="OnSubmit"
           SubmitCaption="OK">
    <ChildContent>

        <EditForm Model="@EditableItem">

            <DataAnnotationsValidator />

            <MudTabs Elevation="3">
                <MudTabPanel Text="Artwork">
                    <EditAlbumArtwork Model="@EditableItem" />
                </MudTabPanel>
                <MudTabPanel Text="Details">
                    <EditAlbumDetails Model="@EditableItem" />
                </MudTabPanel>
                <MudTabPanel Text="Tracks">
                    <EditAlbumTracks Model="@AlbumTracks" />
                </MudTabPanel>
            </MudTabs>

        </EditForm>

    </ChildContent>
</AppDialog>

@code {

    [Inject]
    public IAlbumRepository Repository { get; set; }

    private List<AlbumTrack> AlbumTracks { get; set; } = new();

    protected override async Task OnParametersSetAsync()
    {
        AlbumTracks = await Repository.GetAlbumTracks(Model.Id);
    }
}